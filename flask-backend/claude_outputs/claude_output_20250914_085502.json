{
  "id": "msg_01UJscjVLGpY6pFyFh3dbi9L",
  "type": "message",
  "role": "assistant",
  "model": "claude-opus-4-1-20250805",
  "content": [
    {
      "type": "text",
      "text": "# Concentration Inequalities\n\nEECS 126 (UC Berkeley)  \nFall 2021\n\nSuppose we have a collection of scalar random variables X₁, . . . , Xₙ. We may often wish to analyze the distribution of their sum (or equivalently, their average)\n\nSₙ = X₁ + · · · + Xₙ.\n\nIt turns out that, assuming that our Xᵢ have a sufficient amount of regularity and independence, which will be quantified throughout this section, the probability of being close to the mean will sharply concentrate in a relatively narrow range.\n\n## 1 The Moment Method, Chernoff/Hoeffding Bounds\n\nThe first moment method should be a familiar application of Markov's inequality,\n\nP(|Sₙ| ≥ λ) ≤ (1/λ) ∑ᵢ₌₁ⁿ E|Xᵢ|,                 (1)\n\nas should the second moment method, an application of Chebyshev's inequality,\n\nP(|Sₙ| ≥ λ) ≤ (1/λ²) ∑ᵢ₌₁ⁿ Var(Xᵢ),              (2)\n\nwhere we have assumed that the Xᵢ are pairwise independent.\n\n**Exercise 1.1.** Come up with examples of random variables X₁, . . . , Xₙ in which (1) and (2) are tight.\n\nWe can play a similar game with k-th moments, by assuming k-wise independence. We'd have to do some combinatorial bookkeeping with the terms in\n\nE|Sₙ|ᵏ = ∑₁≤ᵢ₁,...,ᵢₖ≤ₙ EXᵢ₁ . . . Xᵢₖ,\n\nand after some algebra involving Stirling's formula, we can arrive at the large deviation bound\n\nP(|Sₙ| ≥ λ√n) ≤ 2(√(ek/2)/λ)ᵏ.                  (3)\n\nBut instead of dwelling on this, we can often obtain much better bounds using exponential moments, namely by considering the moment generating function Ee^(tSₙ). The following is a bound for a single random variable which will be useful.\n\n**Lemma 1.2 (Hoeffding's lemma)**  \nIf X is a scalar random variable taking values in [a, b], then for any t > 0,\n\nEe^(tX) ≤ e^(tEX)(1 + O(t²Var(X)e^(O(t(b-a))))),     (4)\n\nand in particular,\n\nEe^(tX) ≤ e^(tEX)e^(O(t²Var(X))) ≤ e^(tEX)e^(O(t²(b-a)²)).     (5)\n\n*Proof.* Note that we can subtract the mean from X, a, b and assume that EX = 0. Furthermore, by normalizing X we can assume that b - a = 1. Then X = O(1), and we have the Taylor expansion\n\ne^(tX) = 1 + tX + (tX)²/2! + (tX)³/3! + · · ·\n      = 1 + tX + O(t²X²e^(O(t))).\n\nTaking expectations gives us\n\nEe^(tX) = 1 + O(t²Var(X)e^(O(t))),\n\nproving (4). To get the other bound, note that Var(X) ≤ (b - a)², and consider the function\n\nf(x) = (1 + x²e^x)/e^(x²),\n\nwhich can be shown to be bounded. With x = t(b - a), this gives us (5).\n\nUsing some calculus, we can sharpen Hoeffding's lemma to the following explicit bound:\n\n**Theorem 1.3 (Chernoff bound)**  \nLet X₁, . . . , Xₙ be independent scalar random variables with |Xᵢ| ≤ K almost surely, with means μᵢ and variances σᵢ². Then for any λ > 0, we have\n\nP(|Sₙ - μ| ≥ λσ) ≤ C max{e^(-cλ²), e^(-cλσ/K)},     (6)\n\nwhere C, c > 0 are constants, μ := ∑ᵢ₌₁ⁿ μᵢ, and σ² := ∑ᵢ₌₁ⁿ σᵢ².\n\n*Proof.* We may assume that μᵢ = 0 and K = 1. It then suffices to prove the upper tail bound\n\nP(Sₙ ≥ λσ) ≤ C max{e^(-cλ²), e^(-cλσ)}.\n\nNote that by independence,\n\nEe^(tSₙ) = ∏ᵢ₌₁ⁿ Ee^(tXᵢ).\n\nBy (5) and the fact that |X| ≤ 1, we have\n\nEe^(tXᵢ) ≤ e^(O(t²σᵢ²)),\n\nand together this gives us\n\nEe^(tSₙ) ≤ e^(O(t²σ²)).\n\nBy Markov's inequality, one has\n\nP(Sₙ ≥ λσ) ≤ e^(O(t²σ²)-tλσ).\n\nOptimizing over t subject to the constraint t ∈ [0, 1] gives us (6).\n\n**Exercise 1.4.** By letting t take values in some larger interval than [0, 1], show that the term e^(-cλσ/K) in the Chernoff bound can be replaced with (λK/σ)^(-cλσ/K), which is better for when λK ≫ σ.\n\n**Corollary 1.5 (Hoeffding bound)**  \nLet X₁, . . . , Xₙ be independent random variables taking values in intervals [aᵢ, bᵢ], respectively. Then\n\nP(|Sₙ - ESₙ| ≥ λσ) ≤ Ce^(-cλ²),\n\nwhere C, c > 0 are constants and σ² := ∑ᵢ₌₁ⁿ |bᵢ - aᵢ|².\n\n*Proof.* This follows from Chernoff's bound and the assumption that Var(Sₙ) = ∑ᵢ₌₁ⁿ |bᵢ - aᵢ|².\n\nNotes by Albert Zhang"
    }
  ],
  "stop_reason": "end_turn",
  "stop_sequence": null,
  "usage": {
    "input_tokens": 1754,
    "cache_creation_input_tokens": 0,
    "cache_read_input_tokens": 0,
    "cache_creation": {
      "ephemeral_5m_input_tokens": 0,
      "ephemeral_1h_input_tokens": 0
    },
    "output_tokens": 1768,
    "service_tier": "standard"
  }
}